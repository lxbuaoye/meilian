<view class="page">
  <!-- 自定义导航栏 -->
  <view class="nav-bar" style="padding-top: {{statusBarHeight}}px;">
    <view class="nav-bar-inner" style="height: {{navBarHeight}}px;">
      <view class="nav-left" bindtap="onBackTap">
        <image class="nav-back-icon" src="/image/2.2电子色卡.AI 换色素材/返回@2x.png" mode="aspectFit" />
      </view>
      <view class="nav-title">AI 换色</view>
      <view class="nav-right">
        <view class="nav-dot">···</view>
        <view class="nav-circle"></view>
      </view>
    </view>
  </view>

  <scroll-view class="content" scroll-y="true">
    <!-- 上传图片区域 -->
    <view class="upload-panel">
        <view class="upload-inner" bindtap="onChooseImage">
          <image class="upload-icon" src="/image/2.2电子色卡.AI 换色素材/上传图片@2x.png" mode="aspectFit" />
          <text class="upload-text">拍照/上传图片</text>
      </view>
    </view>

    <!-- 产品选择 -->
    <view class="section">
      <view class="section-header">
        <image class="section-dot" src="/image/2.2电子色卡.AI 换色素材/title@2x.png" mode="aspectFit" />
        <text class="section-title">产品选择</text>
      </view>
      <scroll-view class="product-scroll" scroll-x="true" enable-flex="true">
        <view class="product-list">
          <view wx:for="{{products}}" wx:key="id" class="product-item {{selectedProductMap[index] ? 'product-item--active' : ''}}" bindtap="onSelectProduct" data-index="{{index}}">
            <view class="product-image-wrapper">
              <image class="product-image" src="/image/2.2电子色卡.AI 换色素材/产品.png" mode="aspectFill" />
              <image wx:if="{{selectedProductMap[index]}}" class="product-check" src="/image/2.2电子色卡.AI 换色素材/选中@2x.png" mode="aspectFit" />
            </view>
            <text class="product-name">{{item.name}}</text>
          </view>
        </view>
      </scroll-view>
    </view>

    <!-- 工艺选择 -->
    <view class="section">
      <view class="section-header">
        <image class="section-dot" src="/image/2.2电子色卡.AI 换色素材/title@2x.png" mode="aspectFit" />
        <text class="section-title">工艺选择</text>
      </view>
      <view class="craft-list">
        <view wx:for="{{crafts}}" wx:key="id" class="craft-item {{selectedCraftMap[index] ? 'craft-item--active' : ''}}" bindtap="onSelectCraft" data-index="{{index}}">
          <text class="craft-text">{{item.name}}</text>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- 底部按钮 -->
  <view class="footer">
    <button class="primary-button" bindtap="onGenerateTap" hover-class="primary-button--hover">
      <text class="primary-button-text">AI生成</text>
    </button>
  </view>
</view>