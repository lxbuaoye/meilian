<block wx:if="{{showLoginPopup}}">
  <ai-login header="ğŸ¨ æ™ºèƒ½åˆ†æï¼Œå…¨æ–¹ä½å‡ºæ–¹æ¡ˆ!"
    bind:onloginsuccess="onLoginSuccess"> </ai-login>
</block>

<view style="margin: 24rpx;">
  <user-header bind:unauthorized="onUnauthorized"></user-header>
</view>

<block wx:if="{{loadingReport}}">
  <view style="display: flex; justify-content: center; align-items: center; margin-top: 40rpx;">
    <t-loading theme="circular"
      size="40rpx"
      text="æ­£åœ¨åŠ è½½æŠ¥å‘Š..."
      layout="vertical"
      class="wrapper" />
  </view>
</block>

<view wx:if="{{!loadingReport}}"
  style="display: flex; justify-content: center; align-items: center; flex-direction: column; margin: 24rpx 24rpx;">

  <view style="height: 490rpx; margin: 0 24rpx 0 24rpx; width: 100%; background-color: {{hasResult? 'transparent' : 'rgba(0,0,0,0.1)'}}; position: relative; border-radius: 24rpx; overflow: hidden;">
    <t-sticky bind:scroll="onStickyChange"
      t-class="sticky-container {{activeStickyImage ? 'active': '' }}">
      <image src="{{imageSrc}}"
        wx:if="{{imageSrc}}"
        bind:tap="openViewer"
        class="image {{activeStickyImage ? 'sticky': '' }}"
        mode="aspectFit"></image>
    </t-sticky>
    <view wx:if="{{!imageSrc}}"
      style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 32rpx; display: flex; color: white; justify-content: center; align-items: center; display: flex; flex-direction: column; width: 100%;">
      <view style="justify-content: center; align-items: center; display: flex; flex-direction: column;"
        bind:tap="chooseImage">
        <image src="{{uploadButtonSrc}}"
          style="width: 60rpx; height: 60rpx;"></image>
        <text style="font-size: 28rpx;color: #8F969C; margin-top: 20rpx;">è¯·å…ˆé€‰æ‹©å›¾ç‰‡</text>
      </view>
      <view style="display: flex; justify-content: center; align-items: center; margin-top: 50rpx;"
        bindtap="showExamplePicker"
        wx:if="{{!imageSrc}}">
        <text style="font-size: 24rpx; color: #8F969C; ">(æ²¡æœ‰åˆé€‚çš„å›¾ç‰‡? </text>
        <text style="font-size: 24rpx; color: blue;"> ç‚¹å‡» </text>
        <text style="font-size: 24rpx; color: #8F969C; ">ä½¿ç”¨ç¤ºä¾‹å›¾ç‰‡)</text>
      </view>
    </view>

    <view style="position: absolute; bottom: 24rpx; right: 24rpx; border-radius: 32rpx; display: flex; background: rgba(0,0,0,0.5); justify-content: center; align-items: center;"
      wx:if="{{!hasResult}}">
      <t-icon name="image"
        style="margin-left: 24rpx; color: white;"></t-icon>
      <button type="primary"
        style="background: transparent"
        class="button small-font"
        bindtap="chooseImage">é€‰æ‹©å›¾ç‰‡</button>
    </view>

    <view style="position: absolute; top: 24rpx; right: 24rpx; border-radius: 32rpx; display: flex; background: rgba(0,0,0,0.5); justify-content: center; align-items: center;"
      wx:if="{{imageSrc && !hasResult}}"
      bind:tap="onRemoveImage">
      <t-icon name="delete"
        size="40rpx"
        color="white"
        style="padding: 20rpx;"
        bind:click="onRemoveImage" />
    </view>
  </view>
  <!-- For testing -->

  <button wx:if="{{!hasResult}}"
    style="background: {{isLoading ? 'rgba(0,0,0, 0.2)': '#EDBF58'}} ; border: hidden; color: white; width: 90%; margin-top: 48rpx;"
    bind:tap="generate"
    class="small-font"
    disabled="{{isLoading}}"
    hover-class="action-tile-hover">ç«‹å³åˆ†æ (æ¶ˆè€—5ç§¯åˆ†)
  </button>
  <t-loading style="margin-top: 40rpx;"
    wx:if="{{isLoading}}"
    layout="vertical"
    class="loading"
    text="æŠ¥å‘Šç”Ÿæˆä¸­, è¯·ç¨ç­‰... "></t-loading>


  <view wx:if="{{!hasResult}}"
    style="display: flex; width: 100%; flex-direction: column; margin-top: 30rpx;">
    <view class="container">
      <view class="container">

        <view class="section">
          <view class="section-title">AIä¸€æ‹é€š</view>
          <view class="feature-list">
            <view class="feature-item">
              <text class="feature-text">ğŸ“¸ æ‹ç…§/ä¸Šä¼ ï¼š</text>
              <text style="display: flex;">æ‹æ‘„æˆ–ä¸Šä¼ ç…§ç‰‡</text>
            </view>
            <view class="feature-item">
              <text class="feature-text">ğŸ¨ å…¨é¢åˆ†æï¼š</text>
              <text style="display: flex;">æä¾›é£æ ¼æ¨èã€è‰²å½©æ­é…ã€é¢ç§¯ä¼°ç®—ã€ä½æˆ·åˆ†æã€é£æ°´å»ºè®®å’Œæ¤ç‰©æ¨è</text>
            </view>
          </view>

          <view class="section-title">æ¸©é¦¨æç¤º</view>
          <text class="paragraph">æœ¬æœåŠ¡ä¸ºAIç”Ÿæˆå†…å®¹ï¼Œç»“æœä»…ä¾›å‚è€ƒï¼Œè¯·ç»“åˆå®é™…æƒ…å†µä½¿ç”¨ã€‚
          </text>
        </view>

      </view>

    </view>
  </view>
  <view wx:if="{{hasResult}}"
    style="width: 100%;">

    <t-tabs defaultValue="{{0}}"
      class="tab"
      swipeable="{{false}}"
      theme="card">
      <t-tab-panel label="{{tabLabel}}"
        wx:for="{{reportTabLabels}}"
        wx:for-item="tabLabel"
        wx:key="index"
        value="{{index}}">
        <!-- ç©ºé—´ç”»åƒ -->
        <block wx:if="{{index === 0}}">
          <view class="section-container">
            <!-- ç°çŠ¶è¯„ä¼°ï¼ˆè´Ÿå‘/è­¦ç¤ºç±»ï¼‰ -->
            <view style="margin-top: 20rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">âš ï¸</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">ç°çŠ¶è¯„ä¼°</text>
              </view>
              <view style="padding: 24rpx; background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%); border-radius: 16rpx;">
                <!-- è€åŒ–æŒ‡æ•° -->
                <view style="margin-bottom: 20rpx;">
                  <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8rpx;">
                    <text style="font-size: 26rpx; color:#1c2023;">è€åŒ–æŒ‡æ•°</text>
                    <text style="font-size: 28rpx; color:#ef4444; font-weight: 700;">{{result.spaceProfile.spaceCondition.agingIndex}} åˆ†</text>
                  </view>
                  <view style="height: 8rpx; background-color: #fee2e2; border-radius: 4rpx; overflow: hidden;">
                    <view style="height: 100%; width: {{result.spaceProfile.spaceCondition.agingIndex}}%; background: linear-gradient(90deg, #f97316 0%, #ef4444 100%); border-radius: 4rpx;"></view>
                  </view>
                </view>
                <!-- æŸè€—ç¨‹åº¦ -->
                <view style="margin-bottom: 20rpx;">
                  <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8rpx;">
                    <text style="font-size: 26rpx; color:#1c2023;">æŸè€—ç¨‹åº¦</text>
                    <text style="font-size: 28rpx; color:#ef4444; font-weight: 700;">{{result.spaceProfile.spaceCondition.wearLevel}} åˆ†</text>
                  </view>
                  <view style="height: 8rpx; background-color: #fee2e2; border-radius: 4rpx; overflow: hidden;">
                    <view style="height: 100%; width: {{result.spaceProfile.spaceCondition.wearLevel}}%; background: linear-gradient(90deg, #f97316 0%, #ef4444 100%); border-radius: 4rpx;"></view>
                  </view>
                </view>
                <!-- å®‰å…¨é£é™© -->
                <view style="margin-bottom: 0rpx;">
                  <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8rpx;">
                    <text style="font-size: 26rpx; color:#1c2023;">å®‰å…¨é£é™©</text>
                    <text style="font-size: 28rpx; color:#ef4444; font-weight: 700;">{{result.spaceProfile.spaceCondition.safetyRisk}} åˆ†</text>
                  </view>
                  <view style="height: 8rpx; background-color: #fee2e2; border-radius: 4rpx; overflow: hidden;">
                    <view style="height: 100%; width: {{result.spaceProfile.spaceCondition.safetyRisk}}%; background: linear-gradient(90deg, #f97316 0%, #ef4444 100%); border-radius: 4rpx;"></view>
                  </view>
                </view>
              </view>
            </view>

            <!-- ä»·å€¼è¯„ä¼°ï¼ˆæ­£å‘/æœºä¼šç±»ï¼‰ -->
            <view style="margin-top: 24rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸ’</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">ä»·å€¼è¯„ä¼°</text>
              </view>
              <view style="padding: 24rpx; background: linear-gradient(135deg, #fff9e6 0%, #ffe8a1 100%); border-radius: 16rpx;">
                <!-- æ”¹é€ æ½œåŠ› -->
                <view style="margin-bottom: 20rpx;">
                  <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8rpx;">
                    <text style="font-size: 26rpx; color:#1c2023;">æ”¹é€ æ½œåŠ›</text>
                    <text style="font-size: 28rpx; color:#EDBF58; font-weight: 700;">{{result.spaceProfile.spaceCondition.renovationPotential}} åˆ†</text>
                  </view>
                  <view style="height: 8rpx; background-color: #fef3c7; border-radius: 4rpx; overflow: hidden;">
                    <view style="height: 100%; width: {{result.spaceProfile.spaceCondition.renovationPotential}}%; background: linear-gradient(90deg, #EDBF58 0%, #f59e0b 100%); border-radius: 4rpx;"></view>
                  </view>
                </view>
                <!-- ç¿»æ–°è¿«åˆ‡åº¦ -->
                <view style="margin-bottom: 0rpx;">
                  <view style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8rpx;">
                    <text style="font-size: 26rpx; color:#1c2023;">ç¿»æ–°è¿«åˆ‡åº¦</text>
                    <text style="font-size: 28rpx; color:#EDBF58; font-weight: 700;">{{result.spaceProfile.spaceCondition.renovationUrgency}} åˆ†</text>
                  </view>
                  <view style="height: 8rpx; background-color: #fef3c7; border-radius: 4rpx; overflow: hidden;">
                    <view style="height: 100%; width: {{result.spaceProfile.spaceCondition.renovationUrgency}}%; background: linear-gradient(90deg, #EDBF58 0%, #f59e0b 100%); border-radius: 4rpx;"></view>
                  </view>
                </view>
              </view>
            </view>

            <!-- å»ºç­‘/ç©ºé—´ä½¿ç”¨è€…åˆ†æ -->
            <view style="margin-top: 24rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸ‘¥</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">å»ºç­‘/ç©ºé—´ä½¿ç”¨è€…åˆ†æ</text>
              </view>
              <view style="padding: 24rpx; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 16rpx;">
                <!-- ç©ºé—´ä½¿ç”¨ç‰¹å¾ -->
                <view style="margin-bottom: 20rpx;">
                  <text style="font-size: 24rpx; color:#8F969C; margin-bottom: 12rpx; display: block;">ğŸ  ç©ºé—´ä½¿ç”¨ç‰¹å¾</text>
                  <view style="display: flex; flex-wrap: wrap; margin: -6rpx;">
                    <view wx:for="{{result.spaceProfile.userAnalysis.usagePattern}}"
                      wx:key="*this"
                      style="padding: 12rpx 20rpx; margin: 6rpx; background-color: white; border-radius: 20rpx; border: 1rpx solid #e5e7eb;">
                      <text style="font-size: 24rpx; color:#1c2023;">{{item}}</text>
                    </view>
                  </view>
                </view>
                <!-- å“è´¨å…³æ³¨æ–¹å‘ -->
                <view style="margin-bottom: 20rpx;">
                  <text style="font-size: 24rpx; color:#8F969C; margin-bottom: 12rpx; display: block;">ğŸ’ å“è´¨å…³æ³¨æ–¹å‘</text>
                  <view style="display: flex; flex-wrap: wrap; margin: -6rpx;">
                    <view wx:for="{{result.spaceProfile.userAnalysis.qualityFocus}}"
                      wx:key="*this"
                      style="padding: 12rpx 20rpx; margin: 6rpx; background-color: white; border-radius: 20rpx; border: 1rpx solid #e5e7eb;">
                      <text style="font-size: 24rpx; color:#1c2023;">{{item}}</text>
                    </view>
                  </view>
                </view>
                <!-- å½“å‰é£æ ¼è¯Šæ–­ -->
                <view style="margin-bottom: 20rpx;">
                  <text style="font-size: 24rpx; color:#8F969C; margin-bottom: 12rpx; display: block;">ğŸ¨ å½“å‰é£æ ¼è¯Šæ–­</text>
                  <view style="display: flex; flex-wrap: wrap; margin: -6rpx;">
                    <view wx:for="{{result.spaceProfile.userAnalysis.styleDiagnosis}}"
                      wx:key="*this"
                      style="padding: 12rpx 20rpx; margin: 6rpx; background-color: white; border-radius: 20rpx; border: 1rpx solid #e5e7eb;">
                      <text style="font-size: 24rpx; color:#1c2023;">{{item}}</text>
                    </view>
                  </view>
                </view>
                <!-- æ ¸å¿ƒæ”¹é€ ç—›ç‚¹ -->
                <view style="margin-bottom: 0rpx;">
                  <text style="font-size: 24rpx; color:#8F969C; margin-bottom: 12rpx; display: block;">ğŸ”§ æ ¸å¿ƒæ”¹é€ ç—›ç‚¹</text>
                  <view style="display: flex; flex-wrap: wrap; margin: -6rpx;">
                    <view wx:for="{{result.spaceProfile.userAnalysis.keyRenovationTriggers}}"
                      wx:key="*this"
                      style="padding: 12rpx 20rpx; margin: 6rpx; background-color: white; border-radius: 20rpx; border: 1rpx solid #e5e7eb;">
                      <text style="font-size: 24rpx; color:#1c2023;">{{item}}</text>
                    </view>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </block>

        <!-- æ¨èæ­é… -->
        <block wx:if="{{index === 1}}">
          <view class="section-container">
            <!-- å»ºç­‘ç±»å‹å’Œé£æ ¼ -->
            <view style="margin-top: 20rpx; padding: 24rpx; background: linear-gradient(135deg, #f7fafe 0%, #e8f4fd 100%); border-radius: 16rpx;">
              <view style="margin-bottom: 12rpx;">
                <text style="font-size: 24rpx; color:#8F969C;">å»ºç­‘ç±»å‹</text>
                <view style="margin-top: 8rpx;">
                  <text style="font-size: 28rpx; color:#1c2023; font-weight: 700;">{{result.recommendedMatching.buildingType}}</text>
                </view>
              </view>
              <view style="margin-top: 16rpx; padding-top: 16rpx; border-top: 1rpx solid rgba(0,0,0,0.1);">
                <text style="font-size: 28rpx; color:#1c2023; font-weight: 700;">{{result.recommendedMatching.styleName}}é£æ ¼</text>
                <view style="margin-top: 8rpx;">
                  <text style="font-size: 26rpx; color:#1c2023; line-height: 1.8;">{{result.recommendedMatching.styleDescription}}</text>
                </view>
              </view>
            </view>

            <!-- è‰²å½©æ­é…æ¨è -->
            <view style="margin-top: 24rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸŒˆ</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">è‰²å½©æ­é…æ¨è</text>
              </view>
              <view style="padding: 24rpx; background-color: #f7fafe; border-radius: 16rpx;">
                <view style="margin-top: 12rpx; display: flex; align-items: center;">
                  <text style="font-size: 26rpx; color:#1c2023; margin-right: 12rpx;">ä¸»è‰²ï¼š</text>
                  <view style="width: 40rpx; height: 40rpx; border-radius: 8rpx; background-color: {{result.recommendedMatching.colorScheme.primaryColorRgb}}; border: 2rpx solid rgba(0,0,0,0.1); margin-right: 12rpx;"></view>
                  <text style="font-size: 26rpx; color:#1c2023; font-weight: 700;">{{result.recommendedMatching.colorScheme.primaryColor}}</text>
                </view>
                <view style="margin-top: 16rpx;">
                  <text style="font-size: 26rpx; color:#1c2023; margin-bottom: 8rpx; display: block;">è¾…åŠ©è‰²ï¼š</text>
                  <view style="margin-top: 8rpx;">
                    <view wx:for="{{result.recommendedMatching.colorScheme.secondaryColors}}"
                      wx:key="color"
                      style="display: flex; align-items: center; margin-top: 12rpx;">
                      <view style="width: 40rpx; height: 40rpx; border-radius: 8rpx; background-color: {{item.colorRgb}}; border: 2rpx solid rgba(0,0,0,0.1); margin-right: 12rpx; flex-shrink: 0;"></view>
                      <view style="flex: 1;">
                        <text style="font-size: 26rpx; color:#1c2023; font-weight: 700;">{{item.color}}</text>
                        <text style="font-size: 24rpx; color:#8F969C; margin-left: 8rpx;">ï¼ˆå»ºè®®ç”¨äº{{item.usage}}ï¼‰</text>
                      </view>
                    </view>
                  </view>
                </view>
              </view>
            </view>

            <!-- æ¨èè‰²å¡ -->
            <view style="margin-top: 24rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸ¨</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">æ¨èè‰²å¡</text>
              </view>
              <view style="padding: 20rpx; background-color: #f7fafe; border-radius: 12rpx;">
                <text style="font-size: 26rpx; color:#1c2023;">{{result.recommendedMatching.colorCardSeries}}</text>
              </view>
            </view>

            <!-- æ¤ç‰©æ­é…æ¨è -->
            <view style="margin-top: 24rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸŒ¿</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">æ¤ç‰©æ­é…æ¨è</text>
              </view>
              <view style="padding: 20rpx; background-color: #f7fafe; border-radius: 12rpx;">
                <text style="font-size: 26rpx; color:#1c2023; line-height: 1.8;">{{result.recommendedMatching.plantRecommendation}}</text>
              </view>
            </view>
          </view>
        </block>

        <!-- ä¼°ç®—å¢™é¢é¢ç§¯ -->
        <block wx:if="{{index === 2}}">
          <view class="section-container">
            <!-- ä¸»è¦é¢ç§¯ä¿¡æ¯å¡ç‰‡ -->
            <view style="margin-top: 20rpx; padding: 32rpx; background: linear-gradient(135deg, #fff9e6 0%, #ffe8a1 100%); border-radius: 16rpx; text-align: center;">
              <text style="font-size: 24rpx; color:#8F969C;">å¢™é¢é¢ç§¯ä¼°ç®—</text>
              <view style="margin-top: 12rpx;">
                <text style="font-size: 56rpx; color:#EDBF58; font-weight: 700;">{{result.wallAreaEstimation.estimatedArea}}</text>
                <text style="font-size: 32rpx; color:#EDBF58; font-weight: 700; margin-left: 8rpx;">mÂ²</text>
              </view>
            </view>

            <!-- è¯¦ç»†ä¿¡æ¯ -->
            <view style="margin-top: 24rpx; display: flex; flex-direction: column;">
              <view style="display: flex; justify-content: space-between; align-items: center; padding: 20rpx; background-color: #f7fafe; border-radius: 12rpx; margin-top: 12rpx;">
                <view style="display: flex; align-items: center;">
                  <text style="font-size: 28rpx; margin-right: 8rpx;">ğŸ“Š</text>
                  <text style="font-size: 26rpx; color:#8F969C;">é¢ç§¯åŒºé—´</text>
                </view>
                <text style="font-size: 28rpx; color:#1c2023; font-weight: 700;">{{result.wallAreaEstimation.areaRange.min}} - {{result.wallAreaEstimation.areaRange.max}} mÂ²</text>
              </view>
              <view style="display: flex; justify-content: space-between; align-items: center; padding: 20rpx; background-color: #f7fafe; border-radius: 12rpx; margin-top: 12rpx;">
                <view style="display: flex; align-items: center;">
                  <text style="font-size: 28rpx; margin-right: 8rpx;">ğŸ¯</text>
                  <text style="font-size: 26rpx; color:#8F969C;">ç½®ä¿¡åº¦</text>
                </view>
                <text style="font-size: 28rpx; color:#1c2023; font-weight: 700;">{{result.wallAreaEstimation.confidence}}</text>
              </view>
            </view>

            <!-- æ¸©é¦¨æç¤º -->
            <view style="margin-top: 24rpx; padding: 20rpx; background-color: #fff5f5; border-left: 4rpx solid #EDBF58; border-radius: 8rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 8rpx;">
                <text style="font-size: 28rpx; margin-right: 8rpx;">âš ï¸</text>
                <text style="font-size: 26rpx; color:#8F969C; font-weight: 700;">æ¸©é¦¨æç¤º</text>
              </view>
              <text style="font-size: 24rpx; color:#8F969C; line-height: 1.6;">æœ¬æœåŠ¡ä¸ºAIé¢„ä¼°ç»“æœï¼Œé¢ç§¯æ•°æ®ä»…ä¾›å‚è€ƒï¼Œå»ºè®®ä»¥ç°åœºå®é™…æµ‹é‡ä¸ºå‡†ã€‚</text>
            </view>
          </view>
        </block>

        <!-- é£æ°´ -->
        <block wx:if="{{index === 3}}">
          <view class="section-container">
            <!-- ç°å†µè¯„ä¼° -->
            <view style="margin-top: 20rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸ“Š</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">ç°å†µè¯„ä¼°</text>
              </view>
              <view style="padding: 20rpx; background: linear-gradient(135deg, #f7fafe 0%, #e8f4fd 100%); border-radius: 12rpx;">
                <view style="display: flex; align-items: center; margin-bottom: 12rpx;">
                  <text style="font-size: 28rpx; color:#1c2023; font-weight: 700; margin-right: 16rpx;">{{result.fengshui.currentAssessment.level}}</text>
                  <view style="flex: 1; height: 1rpx; background-color: rgba(0,0,0,0.1);"></view>
                </view>
                <text style="font-size: 26rpx; color:#1c2023; line-height: 1.8;">{{result.fengshui.currentAssessment.reason}}</text>
              </view>
            </view>

            <!-- å¸ƒå±€å»ºè®® -->
            <view style="margin-top: 24rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸ </text>
                <text class="header1-text"
                  style="font-size: 30rpx;">å¸ƒå±€å»ºè®®</text>
              </view>
              <view style="padding: 20rpx; background-color: #f7fafe; border-radius: 12rpx;">
                <text style="font-size: 26rpx; color:#1c2023; line-height: 1.8;">{{result.fengshui.layoutSuggestion}}</text>
              </view>
            </view>

            <!-- è‰²å½©å»ºè®® -->
            <view style="margin-top: 24rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸ¨</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">è‰²å½©å»ºè®®</text>
              </view>
              <view style="padding: 20rpx; background-color: #f7fafe; border-radius: 12rpx;">
                <text style="font-size: 26rpx; color:#1c2023; line-height: 1.8;">{{result.fengshui.colorSuggestion}}</text>
              </view>
            </view>

            <!-- ç‰©ä»¶å¸ƒç½® -->
            <view style="margin-top: 24rpx;">
              <view style="display: flex; align-items: center; margin-bottom: 16rpx;">
                <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸª‘</text>
                <text class="header1-text"
                  style="font-size: 30rpx;">ç‰©ä»¶å¸ƒç½®</text>
              </view>
              <view style="padding: 20rpx; background-color: #f7fafe; border-radius: 12rpx;">
                <text style="font-size: 26rpx; color:#1c2023; line-height: 1.8;">{{result.fengshui.objectArrangement}}</text>
              </view>
            </view>
          </view>
        </block>

        <!-- ç©ºé—´ç„•æ–°è®¡åˆ’ -->
        <block wx:if="{{index === 4}}">
          <view class="section-container">
            <!-- ç©ºé—´ç„•æ–°è®¡åˆ’åˆ—è¡¨ -->
            <view style="margin-top: 20rpx;">
              <view wx:for="{{result.salesProposals.proposals}}"
                wx:key="title"
                wx:for-index="proposalIndex"
                style="margin-top: 20rpx; padding: 24rpx; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 16rpx;">
                <view style="display: flex; align-items: flex-start;">
                  <view style="width: 48rpx; height: 48rpx; border-radius: 24rpx; background: linear-gradient(135deg, #EDBF58 0%, #f59e0b 100%); display: flex; align-items: center; justify-content: center; margin-right: 16rpx; flex-shrink: 0;">
                    <text style="font-size: 28rpx; color: white; font-weight: 700;">{{proposalIndex + 1}}</text>
                  </view>
                  <view style="flex: 1;">
                    <text style="font-size: 30rpx; color:#1c2023; font-weight: 700;">{{item.title}}</text>
                    <view style="margin-top: 12rpx;">
                      <text style="font-size: 26rpx; color:#1c2023; line-height: 1.8;">{{item.description}}</text>
                    </view>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </block>
      </t-tab-panel>
    </t-tabs>

    <!-- åˆ†äº«æœ‹å‹åœˆ/å‘é€ç»™æœ‹å‹-->
    <view class="result-actions"
      style="margin-top: 30rpx;">

      <button class="cute-button jump-to-ai-btn"
        bindtap="navigateToAI">
        <text class="button-icon">âœ¨</text>
        <text>ç‚¹å‡»ä½¿ç”¨æ•°ç å½©AIç”Ÿæˆæ•ˆæœå›¾</text>
        <text class="button-icon">âœ¨</text>
      </button>

      <button class="cute-button retry-button"
        wx:if="betaVersion"
        bindtap="resetGame">
        <text>å†æ¥ä¸€æ¬¡</text>
      </button>
    </view>

    <!-- <view style="display: flex; justify-content: center; align-items: center; margin-top: 40rpx;"
      wx:if="{{!viewOnly}}">
            <t-loading theme="circular"
              size="40rpx"
              text="æ­£åœ¨ç”ŸæˆäºŒç»´ç "
              layout="vertical"
              wx:if="{{!qrcodeSrc}}"
              class="wrapper" />
            <image src="{{qrcodeSrc}}"
              wx:if="{{qrcodeSrc}}"
              show-menu-by-longpress="true"
              style="height: 490rpx; width: 100%;"
              mode="aspectFit"></image>
        </view> -->
  </view>
</view>

<t-message id="t-message" />
<t-toast id="t-toast" />


<example-picker tab-value="{{0}}"
  example-type="DIAGNOSIS"
  bind:selectexampleimage="onSelectExampleImage"
  visible="{{examplePickerVisible}}"></example-picker>